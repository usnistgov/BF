<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2007-1320" Title="BitBlt Heap Buffer Overflow" Description="//generated//&#xD;&#xA;Missing Code (in cirrus_invalidate_region() and others) to Quantity Correct upper bound via applying &amp; s-&gt;cirrus_addr_mask In Use in Codebase (hw/cirrus_vga.c#L642&#xD;&#xA;hw/cirrus_vga.c#L642&#xD;&#xA;hw/cirrus_vga.c#L657&#xD;&#xA;hw/cirrus_vga.c#L674&#xD;&#xA;hw/cirrus_vga.c#L693-#L694&#xD;&#xA;hw/cirrus_vga.c#L744-#L745&#xD;&#xA;hw/cirrus_vga.c#L771-#L772&#xD;&#xA;hw/cirrus_vga.c#L804-#L805&#xD;&#xA;hw/cirrus_vga.c#L1923&#xD;&#xA;hw/cirrus_vga.c#L1946) Bare-Metal (Xen bare-metal hypervisor) leads to Wrong Value (off_cur_end) &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size (in 'while (off_cur &lt; off_cur_end)') Direct Reposition (pointer) Heap Used Codebase (hw/cirrus_vga.c#L664) in Bare-Metal (Xen bare-metal hypervisor) resulting in Overbound Pointer (s-&gt;vram_offset + off_cur) &#xD;&#xA;&#xD;&#xA;, which propagates to Overbound Pointer (in  'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)') Sequential Write Codebase (hw/cirrus_vga.c#L645) in Bare-Metal (Xen bare-metal hypervisor) resulting in Buffer Overflow (heap) &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE (everything could be lost).">
  <DefectWeakness Class="DVR" ClassType="_INP">
    <Cause Comment="in cirrus_invalidate_region() and others" Type="Code">Missing Code</Cause>
    <Operation Comment="upper bound via applying &amp; s-&gt;cirrus_addr_mask">Correct</Operation>
    <Consequence Comment="off_cur_end" Type="Data">Wrong Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">In Use</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Quantity</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L642&#xD;&#xA;hw/cirrus_vga.c#L657&#xD;&#xA;hw/cirrus_vga.c#L674&#xD;&#xA;hw/cirrus_vga.c#L693-#L694&#xD;&#xA;hw/cirrus_vga.c#L744-#L745&#xD;&#xA;hw/cirrus_vga.c#L771-#L772&#xD;&#xA;hw/cirrus_vga.c#L804-#L805&#xD;&#xA;hw/cirrus_vga.c#L1923&#xD;&#xA;hw/cirrus_vga.c#L1946" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL642&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL657&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL674&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL693-L694&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL744-L745&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL771-L772&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL804-L805&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1923&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1946" Trace="" Line="642, 657, 674, 693-694,744-745, 771-772, 804-805, 1923, 1946" /></DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM">
    <Cause Comment="in 'while (off_cur &lt; off_cur_end)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="s-&gt;vram_offset + off_cur" Type="Address">Overbound Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Direct</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L664" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL644" Trace="" Line="664" /></Weakness>
  <Weakness Class="MUS" ClassType="_MEM">
    <Cause Comment="in  'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)'" Type="Address">Overbound Pointer</Cause>
    <Operation>Write</Operation>
    <Consequence Comment="heap" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L645" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL645" Trace="" Line="645" /></Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" Comment="(everything could be lost)" />
  </Failures>
<AuxData Author="Irena Bojanova" Date="2023-12-04T20:28:58" Score="7.2" Criteria="qemu:qemu" BugReport="https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/message/4523S5QJR2GSDHZAA3ER67FQM6U7VH5R/" CodeWithBug="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777" CodeWithFix="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777" CommitId="" /></BFCVE>