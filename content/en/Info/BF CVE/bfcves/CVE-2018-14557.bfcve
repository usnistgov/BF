<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF), BFCVE Tool, Irena Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2018-14557" Title="Tenda firmware until v15.03.06.44_CN(AC7), v15.03.05.19(6318)_CN(AC9), and v15.03.06.23_CN(AC10)" Description="Erroneous declaration of the 's' object leads to a wrong type (char instead of an array of chars), allowing a pointer reposition over its bounds, which, when used in 'sprintf()' leads to stack buffer overflow. If exploited, this can lead to denial of service (DOS) -- availability loss.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code (in 'int ProcessSrvRqst(()') to Sequential Reposition 'result = *sendbuf;' Heap Used in Third-Party (openslp-2.0.0-double-free#L409&#xD;&#xA;openslp/slpd/slpd_process.c#L409) Userland leads to Dangling Pointer ((due to reallocation of the same object via 'sendbuf')) &#xD;&#xA;&#xD;&#xA;, which propagates to Dangling Pointer (in 'ProcessSrvRqst') Explicit Reallocate-Extend ('result = SLPBufferRealloc(result, size);') Heap Third-Party (openslp-2.0.0-double-free#L547&#xD;&#xA;openslp/slpd/slpd_process.c#L556) in Userland  that results in Double Deallocate ((double free)) &#xD;&#xA;&#xD;&#xA;, which can be exploited toward ACE (RCE) (everything could be lost) or DOS (availability loss) security failure." Author="Irena Bojanova, Carlos Galhardo" Date="2023-06-16T17:06:30" Score="7.5" Criteria="tenda:ac7_firmware:*" BugReport="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" CodeWithBug="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" CodeWithFix="" CommitId="">
  <DefectWeakness Class="DCL" ClassType="_DAT" Language="C" File="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" Trace="" Line="5">
    <Cause Comment="in '__fastcall fronNatStaticSetting()'" Type="Code">Erroneous Code</Cause>
    <Operation Comment="in 'char s;'">Declare</Operation>
    <Consequence Comment="(char instead of array of chars)" Type="Type">Wrong Type</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Type="Kind">Data Type</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Comment="while it shoud have been a structure - array of chars" Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Simple</Attribute>
        <Attribute Comment="int __fastcall fromNatStaticSetting(int a1)#L5" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" Trace="" Line="16">
    <Cause Comment="in 'sprintf(&amp;s, &quot;nat_static.asp?page=%s&quot;,v6);'" Type="Type">Wrong Type</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="'&amp;s'" Type="Address">Overbound Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Actual</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="function int __fastcall fromNatStaticSetting(int)#L16" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" Trace="" Line="16">
    <Cause Comment="in 'sprintf(&amp;s, &quot;nat_static.asp?page=%s&quot;,v6);'" Type="Address">Overbound Pointer</Cause>
    <Operation Comment="object">Write</Operation>
    <Consequence Comment="'s'" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="Kind">Moderate</Attribute>
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Actual</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="function int __fastcall fromNatStaticSetting(int a1)#L16" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="DOS" Comment="(availability loss)" />
  </Failures>
</BFCVE>