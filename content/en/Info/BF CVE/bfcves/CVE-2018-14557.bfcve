<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2018-14557" Title="Tenda firmware until v15.03.06.44_CN(AC7), v15.03.05.19(6318)_CN(AC9), and v15.03.06.23_CN(AC10)" Description="Erroneous declaration of the 's' object leads to a wrong type (char instead of an array of chars), allowing a pointer reposition over its bounds, which, when used in 'sprintf()' leads to stack buffer overflow. If exploited, this can lead to denial of service." Author="Carlos Galhardo, Irena Bojanova" Date="2023-06-16T17:06:30" Criteria="tenda:ac7_firmware:*" BugReport="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" CodeWithBug="https://web.archive.org/web/20211209121729/https://github.com/zsjevilhex/iot/blob/master/route/tenda/tenda-03/Tenda.md" CodeWithFix="">
  <DefectWeakness Class="DCL" ClassType="_DAT" Language="C" File="int __fastcall fromNatStaticSetting(int a1)" Trace="" Line="5">
    <Cause Type="Code">Erroneous Code</Cause>
    <Operation Comment="char s;">Declare</Operation>
    <Consequence Comment="char instead of arrays of chars" Type="Type">Wrong Type</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Type="Kind">Data Type</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Comment="while it shoud have been a structure - array of chars" Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Simple</Attribute>
        <Attribute Comment="int __fastcall fromNatStaticSetting(int a1): 5" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="function int __fastcall fromNatStaticSetting(int a1)" Trace="" Line="16">
    <Cause Type="Type">Wrong Type</Cause>
    <Operation Comment="sprintf(&amp;s, &quot;nat_static.asp?page=%s&quot;,v6);">Reposition</Operation>
    <Consequence Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Actual</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="function int __fastcall fromNatStaticSetting(int): 16" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="function int __fastcall fromNatStaticSetting(int a1)" Trace="" Line="16">
    <Cause Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="sprintf(&amp;s, &quot;nat_static.asp?page=%s&quot;,v6);">Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Actual</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="function int __fastcall fromNatStaticSetting(int a1): 16" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="IoT Tenda routers AC7, 9, and 10 devices" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="DOS" />
  </Failures>
</BFCVE>