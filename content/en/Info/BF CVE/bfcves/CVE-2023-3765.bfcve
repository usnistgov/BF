<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF) Tool, I. Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2023-3765" Title="File Injection (absolute path traversal) in GitHub MLflow before v2.5.0" Description="Erroneous validation (does not check for absolute path format with '/', e.g. C:/ or C:/temp/poc.txt) in validate_path_is_safe() leads to file injection -- absolute path traversal. If exploited, this can lead to information exposure, data tempering, or denial of service -- confidentiality, integrity, and availability loss, correspondingly.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Erroneous Code (in 'validate_path_is_safe(path)') to Format Validate absolute path with '/' (to disallow absolute paths, e.g., C:/ or C:/temp/poc.txt) Entered (via API for artifact actions (7 endpoints)) in Codebase (/mlflow/server/handlers.py:#L532-#L533) Local leads to File Injection ((absolute path traversal)) &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to IEX (confidentiality loss) or DOS (availability loss) or TPR (integrity loss)." Author="Eduard Pinconschi, Irena Bojanova" Date="2023-09-11T16:45:59" Score="10.0" Criteria="lfprojects:mlflow" BugReport="https://huntr.dev/bounties/4be5fd63-8a0a-490d-9ee1-f33dc768ed76/" CodeWithBug="https://github.com/mlflow/mlflow/blob/master/mlflow/server/handlers.py" CodeWithFix="https://github.com/mlflow/mlflow/commit/0f2ad0236e355b0816a06670eccf69f57551fa2d" CommitId="">
  <DefectWeakness Class="DVL" ClassType="_INP" Language="Python" File="https://github.com/mlflow/mlflow/commit/0f2ad0236e355b0816a06670eccf69f57551fa2d#diff-5c10a4e2ca47745f06fa9e7201087acfc102849756cb8d85e774a5ac468cb037#L532-#L533" Trace="validate_path_is_safe():524&#xD;&#xA;file_path = os.path.abspath(): 463" Line="532-533">
    <Cause Comment="in 'validate_path_is_safe(path)'" Type="Code">Erroneous Code</Cause>
    <Operation Comment="absolute path with '/'">Validate</Operation>
    <Consequence Comment="(absolute path traversal)" Type="Injection">File Injection</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Comment="via API for artifact actions (7 endpoints)" Type="State">Entered</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="to disallow absolute paths, e.g., C:/ or C:/temp/poc.txt" Type="Mechanism">Format</Attribute>
        <Attribute Comment="/mlflow/server/handlers.py:#L532-#L533" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Failures ClassType="_FLR">
    <Cause Type="Injection">File Injection</Cause>
    <Failure Class="IEX" Comment="(confidentiality loss)" />
    <Failure Class="DOS" Comment="(availability loss)" />
    <Failure Class="TPR" Comment="(integrity loss)" />
  </Failures>
</BFCVE>