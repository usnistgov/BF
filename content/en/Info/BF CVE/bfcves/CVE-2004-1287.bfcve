<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF) Tool, I. Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2004-1287" Title="Stack Buffer Overflow in NASM 0.98.38 1.2" Description="Missing verification of 'arg' towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in ‘vsprintf()' leads to  a stack buffer overflow. If exploited, this can lead to data tampering, denial of service (application crash), or remote code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code (in 'vsprintf(buff, fmt, arg)') to Quantity Verify upper bound Entered in Codebase (preproc.c#L4070) Local leads to Inconsistent Value ('arg') &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size ('arg') Sequential Reposition (pointer) Stack Used Codebase (preproc.c#L4070) in Userland resulting in Over Bounds Pointer ('buff') &#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer ('buff') Sequential Write (object) Stack Used Codebase (preproc.c#L4070) in Userland resulting in Buffer Overflow ('buff') &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE (everything could be lost) or DOS (availability loss) or TPR (integrity loss)." Author="Kedrian James, Irena Bojanova" Date="2023-11-30T07:11:36" Score="10.0" Criteria="nasm:netwide_assembler" BugReport="https://github.com/mudongliang/LinuxFlaw/tree/0f5957b6fe8e2166287c36f9fe2534a5cdc26eca/CVE-2004-1287" CodeWithBug="https://github.com/mudongliang/LinuxFlaw/tree/0f5957b6fe8e2166287c36f9fe2534a5cdc26eca/CVE-2004-1287" CodeWithFix="" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="" Trace="" Line="">
    <Cause Comment="in 'vsprintf(buff, fmt, arg)'" Type="Code">Missing Code</Cause>
    <Operation Comment="upper bound">Verify</Operation>
    <Consequence Comment="'arg'" Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">Entered</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Quantity</Attribute>
        <Attribute Comment="preproc.c#L4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="url to the line " Trace="" Line="">
    <Cause Comment="'arg'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="'buff'" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="preproc.c#L4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="" Trace="" Line="">
    <Cause Comment="'buff'" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="object">Write</Operation>
    <Consequence Comment="'buff'" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="preproc.c#L4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" Comment="(everything could be lost)" />
    <Failure Class="DOS" Comment="(availability loss)" />
    <Failure Class="TPR" Comment="(integrity loss)" />
  </Failures>
</BFCVE>