<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2015-0235" Title="GHOST in GNU glibc v2.2, and other v2.x  before v2.18" Description="Missing factor (the size of the '*h_alias_ptr') while calculating the 'size_needed' size  of a buffer leads to reallocation of not enough memory, allowing a pointer reposition over its bounds, which, when used in 'strcpy()' leads to a heap buffer overflow. If exploited, this can lead to arbitrary code execution." Author="Irena Bojanova, Carlos Calhardo" Date="2023-06-16T17:33:00" Criteria="gnu:glibc:*" BugReport="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithBug="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithFix="https://ftp.gnu.org/gnu/glibc/glibc-2.18.tar.bz2">
  <DefectWeakness Class="TCM" ClassType="_DAT" Language="C" File="nss/digits_dots.c" Trace="" Line="85-86">
    <Cause Comment="incorrect calculation (missing factor)  of buffer size" Type="Code">Erroneous Code</Cause>
    <Operation Comment="size_needed = (sizeof (*host_addr)&#xA; + sizeof (*h_addr_ptrs)&#xA; + sizeof(*h_alias_ptr) + strlen (name) + 1);">Calculate</Operation>
    <Consequence Type="Data">Wrong Result</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to size_needed" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="addition '+'" Type="Mechanism">Operator</Attribute>
        <Attribute Comment="nss/digits_dots.c: 85-86" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="102">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation>Reallocate-Reduce</Operation>
    <Consequence Type="Size">Not Enough Memory</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="nss/digits_dots.c: 102" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="157">
    <Cause Type="Size">Not Enough Memory</Cause>
    <Operation Comment="resbuf-&gt;h_name = strcpy (hostname, name);">Reposition</Operation>
    <Consequence Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c: 157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="157">
    <Cause Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="resbuf-&gt;h_name = strcpy (hostname, name);">Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c: 157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
  </Failures>
</BFCVE>