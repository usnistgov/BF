<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2015-0235" Title="GHOST in GNU glibc v2.2, and other v2.x  before v2.18" Description="Missing factor (the size of '*h_alias_ptr') while calculating the 'size_needed' size  of a buffer leads to reallocation of not enough memory, allowing a pointer reposition over its bounds, which, when used in 'strcpy()' leads to a heap buffer overflow. If exploited, this can lead to arbitrary code execution (ACE) -- everything could be lost.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Erroneous Code (in '__nss_hostname_digits_dots()') to Operator Calculate missing factor -- size of '*h_alias_ptr' (addition '+') Bound (to size_needed) Numeric Primitive in Standard Library (nss/digits_dots.c#L85-#L86) Local leads to Wrong Result ('size_needed') &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size (in ''realloc (*buffer, *buffer_size)') Explicit Reallocate-Reduce ('*buffer_size = size_needed;') Heap Standard Library (nss/digits_dots.c#L102) in Userland  that results in Not Enough Memory (for 'hostname') &#xD;&#xA;&#xD;&#xA;, which propagates to Not Enough Memory (in 'resbuf-&gt;h_name = strcpy (hostname, name);') Sequential Reposition (pointer) Heap Used Standard Library (nss/digits_dots.c#L157) in Userland  that results in Overbound Pointer (of 'hostname') &#xD;&#xA;&#xD;&#xA;, which propagates to Overbound Pointer (in 'resbuf-&gt;h_name = strcpy (hostname, name);') Sequential Write (object) Heap Used Standard Library (nss/digits_dots.c:#L157) in Userland  that results in Buffer Overflow ('hostname') &#xD;&#xA;&#xD;&#xA;, which can be exploited toward ACE (everything could be lost) security failure.">
  <DefectWeakness Class="TCM" ClassType="_DAT">
    <Cause Comment="in '__nss_hostname_digits_dots()'" Type="Code">Erroneous Code</Cause>
    <Operation Comment="missing factor -- size of '*h_alias_ptr'">Calculate</Operation>
    <Consequence Comment="'size_needed'" Type="Data">Wrong Result</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to size_needed" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="addition '+'" Type="Mechanism">Operator</Attribute>
        <Attribute Comment="nss/digits_dots.c#L85-#L86" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="85-86" /></DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM">
    <Cause Comment="in ''realloc (*buffer, *buffer_size)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="'*buffer_size = size_needed;'">Reallocate-Reduce</Operation>
    <Consequence Comment="for 'hostname'" Type="Size">Insufficient Size</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="nss/digits_dots.c#L102" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="102" /></Weakness>
  <Weakness Class="MAD" ClassType="_MEM">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Size">Insufficient Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="of 'hostname'" Type="Address">Overbound Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="157" /></Weakness>
  <Weakness Class="MUS" ClassType="_MEM">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Address">Overbound Pointer</Cause>
    <Operation Comment="object">Write</Operation>
    <Consequence Comment="'hostname'" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c:#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  <AuxData Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="157" /></Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" Comment="(everything could be lost)" />
  </Failures>
<AuxData Author="Irena Bojanova, Carlos Calhardo" Date="2023-06-16T17:33:00" Score="10.0" Criteria="gnu:glibc:*" BugReport="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithBug="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithFix="https://ftp.gnu.org/gnu/glibc/glibc-2.18.tar.bz2" CommitId="" /></BFCVE>