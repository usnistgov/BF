<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF), BFCVE Tool, Irena Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2015-0235" Title="GHOST in GNU glibc v2.2, and other v2.x  before v2.18" Description="Missing factor (the size of '*h_alias_ptr') while calculating the 'size_needed' size  of a buffer leads to reallocation of not enough memory, allowing a pointer reposition over its bounds, which, when used in 'strcpy()' leads to a heap buffer overflow. If exploited, this can lead to arbitrary code execution (ACE) -- everything could be lost." Author="Irena Bojanova, Carlos Calhardo" Date="2023-06-16T17:33:00" Score="10.0" Criteria="gnu:glibc:*" BugReport="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithBug="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithFix="https://ftp.gnu.org/gnu/glibc/glibc-2.18.tar.bz2" CommitId="">
  <DefectWeakness Class="TCM" ClassType="_DAT" Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="85-86">
    <Cause Comment="in '__nss_hostname_digits_dots()'" Type="Code">Erroneous Code</Cause>
    <Operation Comment="missing factor -- size of '*h_alias_ptr'">Calculate</Operation>
    <Consequence Comment="'size_needed'" Type="Data">Wrong Result</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to size_needed" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="addition '+'" Type="Mechanism">Operator</Attribute>
        <Attribute Comment="nss/digits_dots.c#L85-#L86" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="102">
    <Cause Comment="in ''realloc (*buffer, *buffer_size)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="'*buffer_size = size_needed;'">Reallocate-Reduce</Operation>
    <Consequence Comment="for 'hostname'" Type="Size">Not Enough Memory</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="nss/digits_dots.c#L102" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="157">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Size">Not Enough Memory</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="of 'hostname'" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="https://www.openwall.com/lists/oss-security/2015/01/27/9" Trace="" Line="157">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="object">Write</Operation>
    <Consequence Comment="'hostname'" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c:#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" Comment="(everything could be lost)" />
  </Failures>
</BFCVE>