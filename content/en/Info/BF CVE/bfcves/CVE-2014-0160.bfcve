<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF), BFCVE Tool, Irena Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2014-0160" Title="Heartbleed Heap Buffer Over-Read in OpenSSL v1.0.1 before v1.0.1g" Description="Missing verification of 'payload'  towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in 'memcpy()' leads to  a heap buffer over-read. If exploited, this can lead to exposure of sensitive information (IEX) – confidentiality loss. &#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code (in 'dtls1_process_heartbeat(SSL *s)') to Range Verify length (1 + 2 + 16  &lt;= s-&gt;s3-&gt;rrec.length 1 + 2 + payload + 16 &lt;= s-&gt;s3-&gt;rrec.length) Transferred (via network) in Third-Party (ssl/d1_both.c#L1462&#xD;&#xA;ssl/t1_lib.c#L2591) Local leads to Inconsistent Value ('payload') &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size (in 'memcpy(bp, pl, payload)') Sequential Reposition (pointer) Heap Used (for  s→s3→rrec.data[0]) Third-Party (ssl/d1_both.c#L1487&#xD;&#xA;ssl/t1_lib.c#L2620) in Userland  that results in Over Bounds Pointer ('pl') &#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer (in 'memcpy(bp, pl, payload)') Sequential Read (object) Used Huge (up to 64kb per exploit) Heap Third-Party (ssl/d1_both.c#L1487&#xD;&#xA;ssl/t1_lib.c#L2620) in Userland  that results in Buffer Over-Read ('bp') &#xD;&#xA;&#xD;&#xA;, which can be exploited toward IEX (confidentiality loss) security failure." Author="Irena Bojanova, Carlos Galhardo" Date="2023-02-10T11:16:21" Score="5.0" Criteria="openssl:openssl" BugReport="https://www.seancassidy.me/diagnosis-of-the-openssl-heartbleed-bug.html" CodeWithBug="https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/d1_both.c;h=0a84f957118afa9804451add380eca4719a9765e;hb=4817504d069b4c5082161b02a22116ad75f822b1" CodeWithFix="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3" CommitId="96db9023b881d7cd9f379b0c154650d6c108e9a3">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3#diff-6f954bc636343f76cc5f584e115159c89222b1b611fa0cac1059424e481b05b9L1462 &#xD;&#xA;https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3#diff-dab28610cae9e6261080acadaed86ba230fa4daba6f7218cf1134674ea5fe2e4L2591" Trace="ssl/d1_both.c: 1462 &#xD;&#xA;ssl/t1_lib.c: 2591" Line="1462 &#xD;&#xA;2591">
    <Cause Comment="in 'dtls1_process_heartbeat(SSL *s)'" Type="Code">Missing Code</Cause>
    <Operation Comment="length">Verify</Operation>
    <Consequence Comment="'payload'" Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Comment="via network" Type="State">Transferred</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="1 + 2 + 16  &lt;= s-&gt;s3-&gt;rrec.length 1 + 2 + payload + 16 &lt;= s-&gt;s3-&gt;rrec.length" Type="Mechanism">Range</Attribute>
        <Attribute Comment="ssl/d1_both.c#L1462&#xD;&#xA;ssl/t1_lib.c#L2591" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487 &#xD;&#xA;https://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620" Trace="ssl/d1_both.c: 1462, 1487&#xD;&#xA;ssl/t1_lib.c: 2591, 2620" Line="ssl/d1_both.c: 1487 &#xD;&#xA;ssl/t1_lib.c: 2620">
    <Cause Comment="in 'memcpy(bp, pl, payload)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="'pl'" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="Location">Heap</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Comment="for  s→s3→rrec.data[0]" Type="Size">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl/d1_both.c#L1487&#xD;&#xA;ssl/t1_lib.c#L2620" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487 &#xD;&#xA;https://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620" Trace="ssl/d1_both.c: 1462, 1487&#xD;&#xA;ssl/t1_lib.c: 2591, 2620" Line="ssl/d1_both.c: 1487 &#xD;&#xA;ssl/t1_lib.c: 2620">
    <Cause Comment="in 'memcpy(bp, pl, payload)'" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="object">Read</Operation>
    <Consequence Comment="'bp'" Type="Memory Corruption/Disclosure">Buffer Over-Read</Consequence>
    <Attributes>
      <Operand Name="Type">
        <Attribute Type="Size">Used</Attribute>
      </Operand>
      <Operand Name="Address">
        <Attribute Comment="up to 64kb per exploit" Type="Span">Huge</Attribute>
        <Attribute Type="Location">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl/d1_both.c#L1487&#xD;&#xA;ssl/t1_lib.c#L2620" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="see also: https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/t1_lib.c;h=c5c805cce286d12d81c5fdccfe9173d61a68ee82;hb=4817504d069b4c5082161b02a22116ad75f822b1" Type="Memory Corruption/Disclosure">Buffer Over-Read</Cause>
    <Failure Class="IEX" Comment="(confidentiality loss)" />
  </Failures>
</BFCVE>