<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2014-0160" Title="Heartbleed in OpenSSL v1.0.1 before v1.0.1g" Description="Missing verification of 'payload'  length towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in 'memcpy()' leads to  a heap buffer over-read. If exploited, this can lead to exposure of sensitive information – confidentiality loss." Author="Irena Bojanova, Carlos Calhardo" Date="2023-02-10T11:16:21" Criteria="openssl:openssl:*" BugReport="https://www.seancassidy.me/diagnosis-of-the-openssl-heartbleed-bug.html" CodeWithBug="https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/d1_both.c;h=0a84f957118afa9804451add380eca4719a9765e;hb=4817504d069b4c5082161b02a22116ad75f822b1" CodeWithFix="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="ssl /d1_both.c&#xD;&#xA;ssl /t1_lib.c" Trace="" Line="ssl /d1_both.c: 1462&#xD;&#xA;ssl /t1_lib.c: 2591">
    <Cause Comment="to check payload  lenght" Type="Code">Missing Code</Cause>
    <Operation>Verify</Operation>
    <Consequence Comment="for payload size" Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Comment="via network" Type="State">Transferred</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="1 + 2 + 16  &lt;= s-&gt;s3-&gt;rrec.length&#xD;&#xA;1 + 2 + payload + 16 &lt;= s-&gt;s3-&gt;rrec.length" Type="Mechanism">Range</Attribute>
        <Attribute Comment="ssl /d1_both.c: 1462&#xD;&#xA;ssl /t1_lib.c: 2591" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="ssl /d1_both.c&#xD;&#xA;ssl /t1_lib.c" Trace="" Line="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation Comment="memcpy(bp, pl, payload);">Reposition</Operation>
    <Consequence Comment="pl" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Comment="for  s→s3→rrec.data[0]" Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="ssl /d1_both.c&#xD;&#xA;ssl /t1_lib.c" Trace="" Line="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437">
    <Cause Comment="pl" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="memcpy(bp, pl, payload);">Read</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Over-Read</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="see also:&#xD;&#xA;https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/t1_lib.c;h=c5c805cce286d12d81c5fdccfe9173d61a68ee82;hb=4817504d069b4c5082161b02a22116ad75f822b1" Type="Memory Corruption/Disclosure">Buffer Over-Read</Cause>
    <Failure Class="IEX" />
  </Failures>
</BFCVE>