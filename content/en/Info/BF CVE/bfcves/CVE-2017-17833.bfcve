<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF), BFCVE Tool, Irena Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2017-17833" Title="SLPD Double Free in OpenSLP in v1.0.2 and v1.1.0 " Description="Missing reposition of the 'result' pointer leads to a dangling pointer due to reallocation of the same object via 'sendbuf', which, when used to resize (second reallocation) the object leads to a Double Deallocate -- aka double free. If exploited, this can lead to a denial of service (DOS) --availability loss, or arbitrary code execution (ACE) and more specificqlly remote code execution (RCE) -- everything could be lost.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code (in 'int ProcessSrvRqst(()') to Sequential Reposition 'result = *sendbuf;' Heap Used in Third-Party (openslp-2.0.0-double-free#L409&#xD;&#xA;openslp/slpd/slpd_process.c#L409) Userland leads to Dangling Pointer ((due to reallocation of the same object via 'sendbuf')) &#xD;&#xA;&#xD;&#xA;, which propagates to Dangling Pointer (in 'ProcessSrvRqst') Explicit Reallocate-Extend ('result = SLPBufferRealloc(result, size);') Heap Third-Party (openslp-2.0.0-double-free#L547&#xD;&#xA;openslp/slpd/slpd_process.c#L556) in Userland  that results in Double Deallocate ((double free)) &#xD;&#xA;&#xD;&#xA;, which can be exploited toward ACE (RCE) (everything could be lost) or DOS (availability loss) security failure." Author="Irena Bojanova, Carlos Galhardo" Date="2023-06-19T08:42:32" Score="9.8" Criteria="openslp:openslp:1.0.2" BugReport="https://dumpco.re/blog/openslp-2.0.0-double-free" CodeWithBug="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c" CodeWithFix="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c?diff=a53aa0004700c5e65dc72052298503faf3ae3fa0&amp;diformat=sidebyside&#xD;&#xA;https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l466" CommitId="">
  <DefectWeakness Class="MAD" ClassType="_MEM" Language="C" File="https://dumpco.re/blog/openslp-2.0.0-double-free &#xD;&#xA;https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l409" Trace="" Line="409">
    <Cause Comment="in 'int ProcessSrvRqst(()'" Type="Code">Missing Code</Cause>
    <Operation Comment="'result = *sendbuf;'">Reposition</Operation>
    <Consequence Comment="(due to reallocation of the same object via 'sendbuf')" Type="Address">Dangling Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="openslp-2.0.0-double-free#L409&#xD;&#xA;openslp/slpd/slpd_process.c#L409" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="https://dumpco.re/blog/openslp-2.0.0-double-free#L547 &#xD;&#xA;https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l556" Trace="" Line="547">
    <Cause Comment="in 'ProcessSrvRqst'" Type="Address">Dangling Pointer</Cause>
    <Operation Comment="'result = SLPBufferRealloc(result, size);'">Reallocate-Extend</Operation>
    <Consequence Comment="(double free)" Type="Memory Corruption/Disclosure">Double Deallocate</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="openslp-2.0.0-double-free#L547&#xD;&#xA;openslp/slpd/slpd_process.c#L556" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Double Deallocate</Cause>
    <Failure Class="ACE" Comment="(RCE) (everything could be lost)" />
    <Failure Class="DOS" Comment="(availability loss)" />
  </Failures>
</BFCVE>