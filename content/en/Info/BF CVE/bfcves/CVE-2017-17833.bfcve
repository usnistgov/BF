<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2017-17833" Title="SLPD Double Free in OpenSLP in v1.0.2 and v1.1.0 " Description="Missing reposition of the 'result' pointer leads to a dangling pointer due to reallocation of the same object via 'sendbuf', which, when used to resize (second reallocation) the object leads to a Double Free. If exploited, this can lead to a denial of service or an arbitrary (remote) code execution." Author="Carlos Galhardo, Irena Bojanova" Date="2023-06-19T08:42:32" Criteria="openslp:openslp:1.0.2" BugReport="https://dumpco.re/blog/openslp-2.0.0-double-free" CodeWithBug="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/" CodeWithFix="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/">
  <DefectWeakness Class="MAD" ClassType="_MEM" Language="C" File="openslp/slpd/slpd_process.c" Trace="" Line="">
    <Cause Comment="to reposition 'result' as 'sendbuf'" Type="Code">Missing Code</Cause>
    <Operation>Reposition</Operation>
    <Consequence Comment="due to reallocation of the same object via 'sendbuf'" Type="Address">Dangling Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="openslp/slpd/slpd_process.c" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="openslp/slpd/slpd_process.c" Trace="" Line="547">
    <Cause Type="Address">Dangling Pointer</Cause>
    <Operation>Reallocate-Extend</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Double Free</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="openslp/slpd/slpd_process.c: 547" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
    <Failure Class="DOS" />
  </Failures>
</BFCVE>