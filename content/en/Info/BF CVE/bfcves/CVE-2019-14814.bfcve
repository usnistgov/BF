<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2019-14814" Title="Heap Overflow in Marvell wifi diver in Linux kernel up to excluding v5.3" Description="Missing verification of 'rate_ie-&gt;len'  towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in 'memcpy()' leads to  a heap buffer overflow. If exploited, this can lead to denial of service â€“ system crash; and possibly arbitrary code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code  to Range Verify  in Codebase drivers/net/wireless/marvell/mwifiex/uap_cmd.c: 268 leads to Inconsistent Value &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size  Sequential   Reposition in Codebase drivers/net/wireless/marvell/mwifiex/ie.c: 244 resulting in  Heap Over Bounds Pointer &#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer in 'memcpy(bss_cfg-&gt;rates, rate_ie + 1, rate_ie-&gt;len);' Sequential   Write in Codebase drivers/net/wireless/marvell/mwifiex/uap_cmd.c: 394 resulting in  Heap Buffer Overflow &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE or DOS." Author="Carlos Galhardo, Irena Bojanova" Date="2023-06-16T15:39:34" Score="5.5" Criteria="linux:linux_kernel:*" BugReport="https://www.openwall.com/lists/oss-security/2019/08/28/1" CodeWithBug="https://github.com/torvalds/linux/commit/7caac62ed598a196d6ddf8d9c121e12e082cac3?diff=split" CodeWithFix="https://github.com/torvalds/linux/commit/7caac62ed598a196d6ddf8d9c121e12e082cac3?diff=split" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="drivers/net/wireless/marvell/mwifiex/uap_cmd.c" Trace="" Line="268">
    <Cause Type="Code">Missing Code</Cause>
    <Operation>Verify</Operation>
    <Consequence Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">In Use</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="rate_ie-&gt;len &gt; MWIFIEX_SUPPORTED_RATES" Type="Mechanism">Range</Attribute>
        <Attribute Comment="drivers/net/wireless/marvell/mwifiex/uap_cmd.c: 268" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Linux kernel of Wifi Driver" Type="Execution Space">Admin</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="drivers/net/wireless/marvell/mwifiex/ie.c" Trace="" Line="244">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation>Reposition</Operation>
    <Consequence Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="drivers/net/wireless/marvell/mwifiex/ie.c: 244" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Linux kernel of Wifi Driver" Type="Execution Space">Kernel</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="drivers/net/wireless/marvell/mwifiex/uap_cmd.c" Trace="" Line="394">
    <Cause Comment="in 'memcpy(bss_cfg-&gt;rates, rate_ie + 1, rate_ie-&gt;len);'" Type="Address">Over Bounds Pointer</Cause>
    <Operation>Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="drivers/net/wireless/marvell/mwifiex/uap_cmd.c: 394" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Linux kernel of Wifi Driver" Type="Execution Space">Kernel</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="system crash" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
    <Failure Class="DOS" />
  </Failures>
</BFCVE>