
---
weight: 2
title: "BFCVE-2017-17833"
carousel: true
---

<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PJ364XPP9F">
</script>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-PJ364XPP9F');
</script>


## BF Specification of [CVE-2017-17833](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17833) &mdash; SLPD Double Free in OpenSLP in v1.0.2 and v1.1.0 

<div>
<div class="row">
<div class="col-5">
<div>
<div style="text-align:center">
<img src="../../../../BF/images/BFVUL/BFCVE-2017-17833(simple)-0.png" alt="../../../../BF/images/BFVUL/BFCVE-2017-17833(simple)-0.png"/> 
</div>
</div>

</div>
<div class="col">
<div class="row">
<div >
Missing reposition of the 'result' pointer leads to a dangling pointer due to reallocation of the same object via 'sendbuf', which, when used to resize (second reallocation) the object leads to a Double Deallocate -- aka double free. If exploited, this can lead to a denial of service (DOS) --availability loss, or arbitrary code execution (ACE) and more specificqlly remote code execution (RCE) -- everything could be lost.
</div>
<div style="text-align: right;"><button class="btn btn-secondary" type="button" style="width: 260px;" data-bs-toggle="collapse" data-bs-target="#collapseDescr" aria-expanded="false" aria-controls="collapseDescr">Show/Hide Generated Description</button>
</div>
<div class="collapse" id="collapseDescr">
Missing Code (in 'int ProcessSrvRqst(()') to Reposition ('result = *sendbuf;') on Heap with Used size using Sequential mechanism in Third-Party source code (openslp-2.0.0-double-free#L409 openslp/slpd/slpd_process.c#L409) in Userland execution space leads to Dangling Pointer ((due to reallocation of the same object via 'sendbuf')) error, which propagates to
Dangling Pointer (in 'ProcessSrvRqst') to Reallocate-Extend ('result = SLPBufferRealloc(result, size);') using Explicit mechanism in Third-Party source code (openslp-2.0.0-double-free#L547 openslp/slpd/slpd_process.c#L556) in Userland execution space that results in Double Deallocate ((double free)) final error, which can be exploited toward
Arbitrary Code Execution (ACE)  (everything could be lost),Denial of Service (DOS)  (availability loss) security failure.
</div>
</div>
<div class ="row">
<div>
<div id="carouselControls" class="carousel slide" data-interval="false" data-wrap="false">
<div class="carousel-inner">

<div class="carousel-item active" style="text-align:center">
				
<img src="../../../../BF/images/BFVUL/BFCVE-2017-17833-1.png" alt="../../../../BF/images/BFVUL/BFCVE-2017-17833-1.png"/> 
<td>

<br/>[openslp-2.0.0-double-free#L409](https://dumpco.re/blog/openslp-2.0.0-double-free)
<br/>[openslp/slpd/slpd_process.c#L409](https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l409)
</td>
			
</div>
			
<div class="carousel-item" style="text-align:center">
				
<img src="../../../../BF/images/BFVUL/BFCVE-2017-17833-2.png" alt="../../../../BF/images/BFVUL/BFCVE-2017-17833-2.png"/> 
<td>

<br/>[openslp-2.0.0-double-free#L547](https://dumpco.re/blog/openslp-2.0.0-double-free#L547)
<br/>[openslp/slpd/slpd_process.c#L556](https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l556)
</td>
			
</div>
			
<div class="carousel-item" style="text-align:center">
				
<img src="../../../../BF/images/BFVUL/BFCVE-2017-17833-3.png" alt="../../../../BF/images/BFVUL/BFCVE-2017-17833-3.png"/> 
</div>
			
</div>
<button class="carousel-control-prev" type="button" data-bs-target="#carouselControls" data-bs-slide="prev">
<span class="carousel-control-prev-icon" aria-hidden="true"></span>
<span class="visually-hidden">Previous</span>
</button>
<button class="carousel-control-next" type="button" data-bs-target="#carouselControls" data-bs-slide="next">
<span class="carousel-control-next-icon" aria-hidden="true"></span>
<span class="visually-hidden">Next</span>
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<table>
<tr>
<td>

<br/><button class="btn btn-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTable" aria-expanded="false" aria-controls="collapseTable">Show/Hide Definitions</button>
</td><td>

<br/>vendor:product: openslp:openslp
</td><td>

<br/>[Bug Report](https://dumpco.re/blog/openslp-2.0.0-double-free)
</td><td>

<br/>[Code with Fix](https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c?diff=a53aa0004700c5e65dc72052298503faf3ae3fa0&diformat=sidebyside)
<br/>[Code with Fix1](https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c#l466)
</td><td>

<br/>[Code with Bug](https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/tree/openslp/slpd/slpd_process.c)
</td><td>

<br/>[NVD Entry](https://nvd.nist.gov/vuln/detail/)
</td>
</tr>
</table>


<div class="collapse" id="collapseTable">
<table>
		<tr>
		<td>
				<strong>Class</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>MAD</td>
	<td>Memory Addressing (MAD) class – The pointer to an object is initialized, dereferenced, repositioned, or reassigned to an improper memory address.</td>
	</tr>
	<tr>
		<td>MMN</td>
	<td>Memory Management (MMN) class – An object is allocated, resized, or deallocated improperly.</td>
	</tr>
	<tr>
		<td>
				<strong>Operation</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>Reposition</td>
	<td>Reposition operation – Change the pointer to another position inside its object.</td>
	</tr>
	<tr>
		<td>Reallocate-Extend</td>
	<td>Reallocate-Extend operation – Reserve a new larger piece of memory for an object at a new address, reassign its pointer, and release the previous piece of memory.</td>
	</tr>
	<tr>
		<td>
				<strong>Cause/Consequence</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>Code Bug</td>
	<td>Code Bug type – An error in the implementation of an operation – proper operands over an improper operation. It is the roor cause of a security vulnerability. Must be fixed to resolve the vulnerability.</td>
	</tr>
	<tr>
		<td>   Missing Code</td>
	<td>Missing Code bug - The operation is misplaced entirely absent.</td>
	</tr>
	<tr>
		<td>Address Error/Fault</td>
	<td>Address error (or fault) type – The address of an object is wrong.</td>
	</tr>
	<tr>
		<td>   Dangling Pointer</td>
	<td>Dangling Pointer error (or fault) – Still holds the address of its successfully deallocated object (e.g., a pointer to a freed heap object or address of a stack object returned by a function).</td>
	</tr>
	<tr>
		<td>Memory Corruption/Disclosure Final Error</td>
	<td>Memory Corruption/Disclosure final error/exploit vector type – An exploitable or undefined system behavior caused by memory addressing, allocation, use, or deallocation bugs.</td>
	</tr>
	<tr>
		<td>   Double Deallocate</td>
	<td>Double Deallocate final error – An attempt to deallocate a deallocated (freed) object.</td>
	</tr>
	<tr>
		<td>
				<strong>Operation Attribute</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>Mechanism</td>
	<td>Mechanism operation attribute type – Shows how the operation with a bug or faulty operand is performed.</td>
	</tr>
	<tr>
		<td>   Sequential</td>
	<td>Sequential operation attribute – The operation is via iterating over the object elements.</td>
	</tr>
	<tr>
		<td>   Explicit</td>
	<td>Explicit operation attribute – The operation is via a function/method call.</td>
	</tr>
	<tr>
		<td>Source Code</td>
	<td>Source Code operation attribute type – Shows where the code of the operation with a bug or faulty operand resides within the software, firmware, or hardware.</td>
	</tr>
	<tr>
		<td>   Third-Party</td>
	<td>Third-Party operation attribute – The operation code is in a third-party source.</td>
	</tr>
	<tr>
		<td>Execution Space</td>
	<td>Execution Space operation attribute type – Shows where the operation with a bug or faulty operand is executed and the privilege level at which it runs.</td>
	</tr>
	<tr>
		<td>   Userland</td>
	<td>Userland operation attribute – The bugged code runs in an environment with privilege levels, but in unprivileged mode (e.g., ring 3 in x86 architecture).</td>
	</tr>
	<tr>
		<td>
				<strong>Operand Attribute</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>Address State</td>
	<td>Address State operand attribute type – Shows where the address is (i.e., its location) in the memory layout.</td>
	</tr>
	<tr>
		<td>   Heap</td>
	<td>The object is a dynamically allocated data structure (e.g., via malloc() or new).</td>
	</tr>
	<tr>
		<td>Size Kind</td>
	<td>Size Kind operand attribute type – Shows what is used as the size or length (i.e., the number of elements) of an object - e.g., as the limit for traversal over the elements.</td>
	</tr>
	<tr>
		<td>   Used</td>
	<td>Used operand attribute – A supplied value to be used as the size or length (i.e., the number of elements) of an object.</td>
	</tr>
	<tr>
		<td>
				<strong>Failure</strong>
			</td>
	<td>
				<strong>Definition</strong>
			</td>
	</tr>
	<tr>
		<td>ACE</td>
	<td>Arbitrary Code Execution (ACE) – Execution of unauthorized commands or code execution that could lead to everything being lost; remote code execution (RCE) is a sub-case of ACE on a target system or device from a remote location, typically over a network.</td>
	</tr>
	<tr>
		<td>DOS</td>
	<td>Denial of Service (DOS) – Disruption of access to or use of information or information systems that leads to availability loss.</td>
	</tr>
	
</table>
</div>
