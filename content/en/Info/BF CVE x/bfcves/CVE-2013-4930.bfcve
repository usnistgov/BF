<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF), BFCVE Tool, Irena Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2013-4930" Title="Wireshark v1.8.x before v1.8.9 and v1.10.x before v1.10.1 (trace from SARD-231364)" Description="Missing verification on the range for the user-controlled 'len_field' (0, but must be at least 1) results in a wrong value, which becomes a wrong argument for the subtraction ‘-‘ operator in 'len_field-1'. The result is -1 and the sign is flipped; as 'body_len' is unsigned integer, the ‘=’ operator coerces the passed-out result to a distorted value (UINT_MAX), which when used to allocate memory on the heap leads to memory overflow. If exploited, this can lead to denial of service – assertion failure and application exit.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code to Range Verify length  (0, but must be at least 1) (len_field must be at least 1) Stored in Codebase (wireshark-1.8.0/epan/dissectors/packet-dvbci.c#L4044) Local leads to Wrong Value ('len_field') &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Argument (in '*body_len = len_field-1;') Operator Calculate (subtraction '-') Bound (to body_len) Numeric (0) Primitive (guint32) Codebase (wireshark-1.8.0/epan/dissectors/packet-dvbci.c #L4044) in Local resulting in Flipped Sign (as '(len_field-1)' is -1,) &#xD;&#xA;&#xD;&#xA;, which propagates to Flipped Sign (in '*body_len = len_field-1;',,  where body_len is guint32, but is being assigned  -1,) Pass Out Coerce (assignment '=' operator) Bound (to body_len) Numeric (-1) Codebase (wireshark-1.8.0/epan/dissectors/packet-dvbci.c #L4044) in Local resulting in Distorted Value ('UINT_MAX' (large positive integer)) &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size (in 'fd-&gt;data = g_malloc(fd-&gt;len);' ('fd-&gt;len' set from 'frag_data_len' set from 'body_len')) Explicit Allocate (g_malloc()) Heap Userland in resulting in Memory Overflow &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to DOS (assertion failure and application exit) (availability loss)." Author="Irena Bojanova, Carlos Galhardo" Date="2023-03-29T13:56:28" Score="5.0" Criteria="wireshark:wireshark:1.8.0" BugReport="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=8916" CodeWithBug="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=8916" CodeWithFix="http://anonsvn.wireshark.org/viewvc?view=revision&amp;amp;amp;revision=50474" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="wireshark-1.8.0/epan/dissectors/packet-dvbci.c" Trace="" Line="4044">
    <Cause Type="Code">Missing Code</Cause>
    <Operation Comment="length  (0, but must be at least 1)">Verify</Operation>
    <Consequence Comment="'len_field'" Type="Data">Wrong Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">Stored</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="len_field must be at least 1" Type="Mechanism">Range</Attribute>
        <Attribute Comment="wireshark-1.8.0/epan/dissectors/packet-dvbci.c#L4044" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="TCM" ClassType="_DAT" Language="C" File="wireshark-1.8.0/epan/dissectors/packet-dvbci.c" Trace="391, 4071, 4012, 4044" Line="4044">
    <Cause Comment="in '*body_len = len_field-1;'" Type="Data">Wrong Argument</Cause>
    <Operation>Calculate</Operation>
    <Consequence Comment="as '(len_field-1)' is -1," Type="Data">Flipped Sign</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to body_len" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Comment="0" Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Comment="guint32" Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="subtraction '-'" Type="Mechanism">Operator</Attribute>
        <Attribute Comment="wireshark-1.8.0/epan/dissectors/packet-dvbci.c #L4044" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="TCV" ClassType="_DAT" Language="C" File="wireshark-1.8.0/epan/dissectors/packet-dvbci.c" Trace="391, 4071, 4012, 4044" Line="4044">
    <Cause Comment="in '*body_len = len_field-1;',,  where body_len is guint32, but is being assigned  -1," Type="Data">Flipped Sign</Cause>
    <Operation>Coerce</Operation>
    <Consequence Comment="'UINT_MAX' (large positive integer)" Type="Data">Distorted Value</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to body_len" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Comment="-1" Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="assignment '=' operator" Type="Mechanism">Pass Out</Attribute>
        <Attribute Comment="wireshark-1.8.0/epan/dissectors/packet-dvbci.c #L4044" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="" File="" Trace="" Line="">
    <Cause Comment="in 'fd-&gt;data = g_malloc(fd-&gt;len);' ('fd-&gt;len' set from 'frag_data_len' set from 'body_len')" Type="Data">Wrong Size</Cause>
    <Operation>Allocate</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Memory Overflow</Consequence>
    <Attributes>
      <Operand Name="Size">
        <Attribute Type="Kind">Actual</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="g_malloc()" Type="Mechanism">Explicit</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Memory Overflow</Cause>
    <Failure Class="DOS" Comment="(assertion failure and application exit) (availability loss)" />
  </Failures>
</BFCVE>